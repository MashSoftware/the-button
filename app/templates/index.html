{% extends "base.html" %}
{% block content %}
{% if current_user.is_anonymous %}
<div class="row">
    <div class="col">
        <div class="jumbotron">
            <h1 class="display-4">Push the button...</h1>
            <p class="lead">Time tracking made simple.</p>
            <a class="btn btn-primary btn-lg" href="{{ url_for('signup') }}" role="button"><i class="fas fa-user-plus fa-lg fa-fw"></i> Sign up</a>
            <a class="btn btn-secondary btn-lg" href="{{ url_for('login') }}" role="button"><i class="fas fa-sign-in-alt fa-lg fa-fw"></i> Log in</a>
        </div>
    </div>
</div>
<div class="row">
    <div class="col">
        <h2><i class="fas fa-stopwatch fa-lg fa-fw"></i> Simple</h2>
        <p class="lead">Clear, quick and simple to use. Just click to start, click again to finish, job done! Made a mistake? Edit or delete your entries. Want to add a time entry manually? You can do that too. <i>COMING SOON: categorise your time with tags!</i></p>
    </div>
</div>
<hr>
<div class="row">
    <div class="col">
        <h2><i class="fas fa-tachometer-alt fa-lg fa-fw"></i> Fast</h2>
        <p class="lead">A lightweight and fast user interface. Minified, compressed and served from large CDNs. Reasonable rate limits protect the app from abuse and maintain a good service for everyone. Scores a perfect 100% on Google's PageSpeed analysis!</p>
    </div>
</div>
<hr>
<div class="row">
    <div class="col">
        <h2><i class="fas fa-shield-alt fa-lg fa-fw"></i> Secure</h2>
        <p class="lead">Uses security standards and strict policies to protect from cross-site scripting, code injection, cross-site request forgery and session hijacking attacks. Passwords are encrypted and resistant to rainbow table, dictionary and brute force attacks.</p>
    </div>
</div>
<hr>
<div class="row">
    <div class="col">
        <h2><i class="fas fa-globe-europe fa-lg fa-fw"></i> Web first</h2>
        <p class="lead">We treat the browser as a first-class citizen, not just a fallback option. Mobile-first responsive design means The Button looks great and works well on any device. The web is open, democratic and free in a way that app marketplaces tend not to be.</p>
    </div>
</div>
<hr>
<div class="row">
    <div class="col">
        <h2><i class="fas fa-database fa-lg fa-fw"></i> Open</h2>
        <p class="lead">Fully open source code, all hosted and run within the EU. Stores the least amount of personal data possible, only an email address. You are in full control of your data and can permanently delete everything at any time with a single click.</p>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-md-4">
        <div class="btn-group btn-block">
            <a class="btn btn-primary btn-lg btn-block" href="{{ url_for('create_event') }}" role="button">
                <h1>{% if start %}Start now{% else %}Stop now{% endif %}</h1>
            </a>
            <button type="button" class="btn btn-lg btn-primary dropdown-toggle dropdown-toggle-split"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="{{ url_for('manual_event') }}">Manual entry</a>
            </div>
        </div>
        <br><br>
    </div>
    <div class="col-md-8">
        {% for event in events.items %}
        {% if loop.index == 1 or event.started_at.strftime('%y%m%d') != loop.previtem.started_at.strftime('%y%m%d') %}
        <div class="card shadow-sm">
            <h5 class="card-header">{{ event.started_at.strftime('%A %d %B %Y') }}</h5>
            <div class="list-group list-group-flush">
                {% for this_event in events.items %}
                    {% if this_event.started_at.strftime('%Y%m%d') == event.started_at.strftime('%Y%m%d') %}
                        {% if this_event.ended_at is none %}
                        <a href="{{ url_for('update_event', id=this_event.id) }}" class="list-group-item list-group-item-action list-group-item-info">
                        {% else %}
                        <a href="{{ url_for('update_event', id=this_event.id) }}" class="list-group-item list-group-item-action">
                        {% endif %}
                        {% if this_event.ended_at %}
                            {% if this_event.started_at.strftime('%Y%m%d') != this_event.ended_at.strftime('%Y%m%d') %}
                                {{ this_event.started_at.strftime('%H:%M') }} to {{ this_event.ended_at.strftime('%d/%m/%Y') }} at {{ this_event.ended_at.strftime('%H:%M') }}
                            {% else %}
                                {{ this_event.started_at.strftime('%H:%M') }} to {{ this_event.ended_at.strftime('%H:%M')}}
                            {% endif %}
                        {% else %}
                            Started at {{ this_event.started_at.strftime('%H:%M') }}
                        {% endif %}
                    {% endif %}
                {% endfor %}
                </a>
            </div>
        </div>
        <br>
        {% endif %}
        {% endfor %}
        {% if events.items %}
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                {% if events.has_prev %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('index', page=events.prev_num) }}" aria-label="Previous"><i class="fas fa-chevron-left"></i></a>
                </li>
                {% else %}
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true"><i class="fas fa-chevron-left"></i></a>
                </li>
                {% endif %}
                {% for page in events.iter_pages() %}
                    {% if page %}
                        {% if page != events.page %}
                        <li class="page-item">
                            <a class="page-link" href="{{ url_for('index', page=page) }}">{{ page }}</a>
                        </li>
                        {% else %}
                        <li class="page-item active" aria-current="page">
                            <a class="page-link" href="{{ url_for('index', page=page) }}">{{ page }} <span class="sr-only">(current)</span></a>
                        </li>
                        {% endif %}
                    {% endif %}
                {% endfor %}
                {% if events.has_next %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('index', page=events.next_num) }}" aria-label="Next"><i class="fas fa-chevron-right"></i></a>
                </li>
                {% else %}
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true"><i class="fas fa-chevron-right"></i></a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
</div>
{% endif %}
{% endblock %}